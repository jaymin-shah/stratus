!function(e,t){"function"==typeof define&&define.amd?define(["exports","lodash","jquery","bowser"],function(n,o,s,i){return e.Stratus=t(n,o,s,i)}):e.Stratus=t(e.exports,e._,e.jQuery,e.bowser)}(this,function(e,t,n,o){let s={Settings:{image:{size:{xs:200,s:400,m:600,l:800,xl:1200,hq:1600}},status:{reset:-2,deleted:-1,inactive:0,active:1},consent:{reject:-1,pending:0,accept:1}},DOM:{},Key:{},PostMessage:{},LocalStorage:{},Selector:{},Select:null,BaseUrl:(boot&&t.has(boot,"configuration")?boot.configuration.baseUrl:null)||"/",BundlePath:(boot&&t.has(boot,"configuration")?boot.configuration.bundlePath:"")||"",Events:null,Apps:{},Catalog:{},Compendium:{},Components:{},Controllers:{},Directives:{},Filters:{},Modules:{ngMaterial:!0,ngMessages:!0},Services:{},Client:o,CSS:{},Chronos:null,Data:{},Environment:{ip:null,production:!("string"==typeof document.cookie&&-1!==document.cookie.indexOf("env=")),context:null,contextId:null,contextMasterSiteId:null,siteId:null,masterSiteId:null,language:navigator.language,timezone:null,trackLocation:0,trackLocationConsent:0,lat:null,lng:null,postalCode:null,city:null,region:null,country:null,debugNest:!1,liveEdit:!1,viewPortChange:!1,viewPort:null,lastScroll:!1},History:{},Instances:{},Internals:{},Loaders:{},Prototypes:{},Resources:{},Roster:{controller:{selector:"[ng-controller]",namespace:"stratus.controllers."},components:{namespace:"stratus.components."},directives:{namespace:"stratus.directives.",type:"attribute"},flex:{selector:"[flex]",require:["angular","angular-material"]},chart:{selector:"[chart]",require:["angular","angular-chart"],module:!0,suffix:".js"},modules:{selector:["[ng-sanitize]","[froala]"],namespace:"angular-",module:!0},countUp:{selector:["[count-up]","[scroll-spy]"],namespace:"angular-",module:!0,suffix:"Module"},uiTree:{selector:"[ui-tree]",require:["angular-ui-tree"],module:"ui.tree"}},RegisterGroup:{},Api:{GoogleMaps:"AIzaSyBatGvzPR7u7NZ3tsCy93xj4gEBfytffyA",Froala:"KybxhzguB-7j1jC3A-16y=="}};s.Environment.production||console.group("Stratus Warm Up"),t.templateSettings={evaluate:/\{%(.+?)%\}/g,interpolate:/\{\{(.+?)\}\}/g,escape:/\{#(.+?)#\}/g},t.mixin({any:t.some,all:t.every,compose:t.flowRight,contains:t.includes,findWhere:t.find,indexBy:t.keyBy,mapObject:t.mapValues,object:t.zipObject,omit:t.omitBy,pairs:t.toPairs,pluck:t.map,where:t.filter,functionName:function(e){return t.isEmpty(e)?null:(t.isString(e)||(e=e.toString()),(e=e.substr("function ".length)).substr(0,e.indexOf("(")))},ucfirst:function(e){return"string"==typeof e&&e?e.charAt(0).toUpperCase()+e.substring(1):null},lcfirst:function(e){return"string"==typeof e&&e?e.charAt(0).toLowerCase()+e.substring(1):null},cookie:function(e,n,o,s,i){let r={name:e,value:n,expires:o,path:s||"/",domain:i};if(e&&"object"==typeof e&&t.extend(r,e),void 0===r.value){let e=new RegExp("(?:^"+r.name+"|;\\s*"+r.name+")=(.*?)(?:;|$)","g").exec(document.cookie);return null===e?null:e[1]}{let e=r.name+"="+escape(r.value)+";";r.expires&&(r.expires instanceof Date?isNaN(r.expires.getTime())&&(r.expires=new Date):r.expires=new Date((new Date).getTime()+1e3*t.seconds(r.expires)),e+="expires="+r.expires.toUTCString()+";"),r.path&&(e+="path="+r.path+";"),r.domain&&(e+="domain="+r.domain+";"),document.cookie=e}},converge:function(e,n){if("string"!=typeof n&&(n="min"),"min"===n){let n=t.min(e);return t.findKey(e,function(e){return e===n})}if("radial"===n);else if("gauss"!==n)return e},repeat:function(e,t){if("function"==typeof e&&"number"==typeof t){let n;for(n=0;n<t;n++)e()}else console.warn("Underscore cannot repeat function:",e,"with number of times:",t)},dehydrate:function(e){return"string"==typeof e?e:JSON.stringify(e)},hydrate:function(e){return t.isJSON(e)?JSON.parse(e):e},hydrateString:function(e){return t.hydrate(e)},cloneDeep:function(e){if("object"!=typeof e)return e;let n=t.clone(e);return t.each(n,function(e,o){n[o]=t.cloneDeep(e)}),n},extendDeep:function(e,n){let o=t.clone(e);return n&&"object"==typeof n?t.each(n,function(e,s){o&&"object"==typeof o&&(o[s]=s in o?t.extendDeep(o[s],n[s]):n[s])}):o=n,o},getAnchorParams:function(e,n){let o={},s=window.location.hash;if(t.isEmpty(s))return o;const i=/([a-zA-Z]+)(?:\/([0-9]+))?/g;let r;for(;r=i.exec(s);)o[r[1]]=t.hydrate(r[2]);return void 0!==e&&e?o[e]:o},getUrlParams:function(e,n){const o={};void 0===n&&(n=window.location.href);const s=n.indexOf("#");return s>=0&&(n=n.substring(0,s)),n.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,n,s){o[n]=t.hydrate(s)}),void 0!==e&&e?o[e]:o},setUrlParams:function(e,n){if(void 0===n&&(n=window.location.href),void 0===e)return n;let o={};const s=n.indexOf("?"),i=n.indexOf("#");let r="";return i>=0&&(r=n.substring(i,n.length),n=n.substring(0,i)),n.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(e,t,n){o[t]=n}),o=t.extend(o,e),(s>=0?n.substring(0,s):n)+"?"+t.map(o,function(e,n){return n+"="+t.dehydrate(e)}).reduce(function(e,t){return e+"&"+t})+r},allTrue:function(e){return"object"==typeof e&&t.every(e,function(e){return e})},isJSON:function(e){try{JSON.parse(e)}catch(e){return!1}return!0},isAngular:function(e){return"object"==typeof angular&&angular&&angular.element&&e instanceof angular.element},isjQuery:function(e){return"function"==typeof n&&e instanceof n},seconds:function(e){let n=0;if("string"==typeof e){let o=e.match(/([\d+.]*[\d+])(?=[sSmMhHdDwWyY]+)([sSmMhHdDwWyY]+)/gi);if(t.size(o)){let e,s,i,r=/([\d+.]*[\d+])(?=[sSmMhHdDwWyY]+)([sSmMhHdDwWyY]+)/i;t.each(o,function(t){if(e=r.exec(t),i=parseFloat(e[1]),s=e[2],!isNaN(i)){switch(e[2]){case"s":s=1;break;case"m":s=60;break;case"h":s=3600;break;case"d":s=86400;break;case"w":s=604800;break;case"y":s=31558149.504;break;default:s=0}n+=i*s}},this)}else n=null}else n="number"==typeof e?e:null;return n},camelToKebab:function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},kebabToCamel:function(e){return e.replace(/(-\w)/g,function(e){return e[1].toUpperCase()})},camelToSnake:function(e){return e.replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase()},snakeToCamel:function(e){return e.replace(/(_\w)/g,function(e){return e[1].toUpperCase()})},startsWith:function(e,t){return"string"==typeof e&&e.substr(0,t.length).toLowerCase()===t.toLowerCase()},endsWith:function(e,t){return"string"==typeof e&&e.substr(e.length-t.length,e.length).toLowerCase()===t.toLowerCase()},patch:function(e,n){if(!t.isObject(e)||!t.size(e))return null;let o={},s={eax:void 0,ebx:void 0,ecx:void 0,edx:void 0};if(t.isObject(n)&&t.size(n)){let i=function(e,r){s.eax=s.ecx?s.ecx+"."+r:r,t.isObject(e)?(s.ecx=s.eax,t.each(e,i),s.ecx=s.ecx===r?void 0:s.ecx.substring(0,s.ecx.lastIndexOf("."))):(s.ebx=t.reduce(s.eax.split("."),function(e,t){return e&&e[t]},n),s.ebx!==e&&(s.edx=e)),void 0!==s.edx&&(o[s.eax]=e,s.edx=void 0)};t.each(e,i)}else console.error("bad prior:",n);return o&&t.size(o)?o:null},poll:function(e,t,n){t=t||2e3,n=n||100;const o=Number(new Date)+t,s=function(t,i){const r=e();r?t(r):Number(new Date)<o?setTimeout(s,n,t,i):i(new Error("Timeout "+e+": "+arguments))};return new Promise(s)},strcmp:function(e,t){let n,o;for(e=e.toString(),t=t.toString(),n=0,o=Math.max(e.length,t.length);n<o&&e.charAt(n)===t.charAt(n);++n);return n===o?0:e.charAt(n)>t.charAt(n)?-1:1},truncate:function(e,t,n){t=t||100,n=n||"...";let o,s,i,r,a,l=e.replace(/</g,"\n<").replace(/>/g,">\n").replace(/\n\n/g,"\n").replace(/^\n/g,"").replace(/\n$/g,"").split("\n"),c=0,u=[];for(let e=0;e<l.length;e++){let d=(o=l[e]).replace(/[ ]+/g," ");if(o.length){if("<"!==o[0])if(c>=t)o="";else if(c+d.length>=t){if(" "===o[(s=t-c)-1])for(;s&&" "===o[(s-=1)-1];);else-1!==(i=o.substring(s).split("").indexOf(" "))?s+=i:s=o.length;o=o.substring(0,s)+n,c=t}else c+=d.length;else if(c>=t)if(a=(r=o.match(/[a-zA-Z]+/))?r[0]:"")if("</"!==o.substring(0,2))u.push(a),o="";else{for(;u[u.length-1]!==a&&u.length;)u.pop();u.length&&(o=""),u.pop()}else o="";l[e]=o}}return l.join("\n").replace(/\n/g,"")}}),s.Prototypes.EventManager=class{constructor(e){this.name="EventManager",this.listeners={},this.throttleTrigger=t.throttle(this.trigger,e||100)}off(e,t,n){return console.log("off:",arguments),this}on(e,t,n){const o=e instanceof s.Prototypes.Event?e:new s.Prototypes.Event({enabled:!0,hook:e,method:t,scope:n||null});return(e=o.hook)in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(o),this}once(e,n,o){return this.on(e,function(e,...o){e.enabled=!1;let s=t.clone(o);s.unshift(e),n.apply(e.scope||this,s)},o),this}trigger(e,...n){return e in this.listeners?(this.listeners[e].forEach(function(e){if(!e.enabled)return;let o=t.clone(n);o.unshift(e),e.method.apply(e.scope||this,o)}),this):this}},s.Events=new s.Prototypes.EventManager,s.Prototypes.Error=class{constructor(e,n){this.code="Internal",this.message="No discernible data received.",this.chain=[],"string"==typeof e?this.message=e:e&&"object"==typeof e&&t.extend(this,e),this.chain.push(n)}},s.Prototypes.Event=class{constructor(e){this.enabled=!1,this.hook=null,this.target=null,this.scope=null,this.debounce=null,this.throttle=null,this.method=function(){console.warn("No method:",this)},e&&"object"==typeof e&&t.extend(this,e),this.listening=!1,this.invalid=!1,"string"!=typeof this.hook&&(console.error("Unsupported hook:",this.hook),this.invalid=!0),void 0===this.target||null===this.target||this.target instanceof EventTarget||(console.error("Unsupported target:",this.target),this.invalid=!0),"function"!=typeof this.method&&(console.error("Unsupported method:",this.method),this.invalid=!0),this.invalid&&(this.enabled=!1)}},s.Prototypes.Job=class{constructor(e,n,o){this.enabled=!1,e&&"object"==typeof e?t.extend(this,e):(this.time=e,this.method=n,this.scope=o),this.time=t.seconds(this.time),this.scope=this.scope||window}},s.Prototypes.Model=class extends s.Prototypes.EventManager{constructor(e,n){super(),this.name="Model",this.data={},this.temps={},this.changed=!1,this.watching=!1,this.patch={},e&&t.extend(this.data,e),this.toObject=this.toObject.bind(this),this.toJSON=this.toJSON.bind(this),this.each=this.each.bind(this),this.get=this.get.bind(this),this.has=this.has.bind(this),this.size=this.size.bind(this),this.set=this.set.bind(this),this.setAttribute=this.setAttribute.bind(this),this.temp=this.temp.bind(this),this.add=this.add.bind(this),this.remove=this.remove.bind(this),this.iterate=this.iterate.bind(this),this.clear=this.clear.bind(this),this.clearTemp=this.clearTemp.bind(this)}toObject(e){return t.clone(this.data)}toJSON(e){return t.clone(this.data)}each(e,n){t.each.apply(void 0===n?this:n,t.union([this.data],arguments))}get(e){return t.reduce("string"==typeof e?e.split("."):[],function(e,t){return e&&e[t]},this.data)}has(e){return void 0!==this.get(e)}size(){return t.size(this.data)}set(e,n){if(e&&"object"==typeof e){let n=this;t.each(e,function(e,t){n.setAttribute(t,e)},this)}else this.setAttribute(e,n)}setAttribute(e,n){if("string"==typeof e)if(-1!==e.indexOf(".")){let o=this.data,s=e.split(".");if(t.find(t.initial(s),function(e){if(t.has(o,e)&&o[e]||(o[e]={}),void 0===o||!o||"object"!=typeof o)return o=this.data,!0;o=o[e]},this),!t.isEqual(o,this.data)){let i=t.last(s);!o||"object"!=typeof o||t.has(o,i)&&t.isEqual(o[i],n)||(o[i]=n,this.trigger("change:"+e,this),this.trigger("change",this))}}else t.has(this.data,e)&&t.isEqual(this.data[e],n)||(this.data[e]=n,this.trigger("change:"+e,this),this.trigger("change",this))}temp(e,n){this.set(e,n),e&&"object"==typeof e?t.each(e,function(e,t){this.temps[t]=e},this):this.temps[e]=n}add(e,n){if(this.has(e)||this.set(e,[]),void 0!==n&&!t.contains(this.data[e],n))return this.data[e].push(n),n}remove(e,n){return void 0===n||(this.data[e]=t.without(this.data[e],n)),this.data[e]}iterate(e){return this.has(e)||this.set(e,0),++this.data[e]}clear(){for(let e in this.data)this.data.hasOwnProperty(e)&&delete this.data[e]}clearTemp(){for(let e in this.temps)this.temps.hasOwnProperty(e)&&delete this.temps[e]}},s.Collections=new s.Prototypes.Model,s.Models=new s.Prototypes.Model,s.Routers=new s.Prototypes.Model,s.Environment=new s.Prototypes.Model(s.Environment),s.Prototypes.Sentinel=class{constructor(){this.view=!1,this.create=!1,this.edit=!1,this.delete=!1,this.publish=!1,this.design=!1,this.dev=!1,this.master=!1,this.zero=this.zero.bind(this),this.permissions=this.permissions.bind(this),this.summary=this.summary.bind(this)}zero(){t.extend(this,{view:!1,create:!1,edit:!1,delete:!1,publish:!1,design:!1,dev:!1,master:!1})}permissions(e){if(isNaN(e)){let e=0;return e+=this.view?1:0,e+=this.create?2:0,e+=this.edit?4:0,e+=this.delete?8:0,e+=this.publish?16:0,e+=this.design?32:0,e+=this.dev?64:0,e+=this.master?128:0}t.each(e.toString(2).split("").reverse(),function(e,t){if("1"===e)switch(t){case 0:this.view=!0;break;case 1:this.create=!0;break;case 2:this.edit=!0;break;case 3:this.delete=!0;break;case 4:this.publish=!0;break;case 5:this.design=!0;break;case 6:this.dev=!0;break;case 7:this.view=!0,this.create=!0,this.edit=!0,this.delete=!0,this.publish=!0,this.design=!0,this.dev=!0,this.master=!0}},this)}summary(){let e=[];return t.each(this,function(n,o){"boolean"==typeof n&&n&&e.push(t.ucfirst(o))}),e}},s.Prototypes.Toast=class{constructor(e,n,o,s){e&&"object"==typeof e?(t.extend(this,e),this.message=this.message||"Message"):this.message=e||"Message",this.title=this.title||n||"Toast",this.priority=this.priority||o||"danger",this.settings=this.settings||s,this.settings&&"object"==typeof this.settings||(this.settings={}),this.settings.timeout=this.settings.timeout||1e4}},s.Internals.XHR=function(e){this.method="GET",this.url="/Api",this.data={},this.type="",this.success=function(e){return e},this.error=function(e){return e},t.extend(this,e);let n=this;this.xhr=new window.XMLHttpRequest;let o=new Promise(function(e,o){n.xhr.open(n.method,n.url,!0),"string"==typeof n.type&&n.type.length&&n.xhr.setRequestHeader("Content-Type",n.type),n.xhr.onload=function(){if(n.xhr.status>=200&&n.xhr.status<400){let o=n.xhr.responseText;t.isJSON(o)&&(o=JSON.parse(o)),e(o)}else o(n.xhr)},n.xhr.onerror=function(){o(n.xhr)},Object.keys(n.data).length?n.xhr.send(JSON.stringify(n.data)):n.xhr.send()});return o.then(n.success,n.error),o},s.Internals.Anchor=function e(){e.initialize=!0}(),s.Internals.Api=function(e,n,o){return void 0===e&&(e="Default"),null==n&&(n={}),void 0===o&&(o={}),"object"!=typeof n&&(n={method:n}),t.has(n,"method")||(n.method="GET"),s.Internals.Convoy({route:{controller:e},meta:n,payload:o})},s.Internals.Compatibility=function(){let e=[];s.Client.android?e.push("android"):s.Client.ios?e.push("ios"):s.Client.mac?e.push("mac"):s.Client.windows?e.push("windows"):s.Client.linux?e.push("linux"):e.push("os"),s.Client.chrome?e.push("chrome"):s.Client.firefox?e.push("firefox"):s.Client.safari?e.push("safari"):s.Client.opera?e.push("opera"):s.Client.msie?e.push("msie"):s.Client.iphone?e.push("iphone"):e.push("browser"),s.Client.version&&e.push("version"+s.Client.version.split(".")[0]),s.Client.mobile?e.push("mobile"):s.Client.tablet?e.push("tablet"):e.push("desktop"),s("body").addClass(e.join(" "))},s.Internals.Convoy=function(e,o){return new Promise(function(i,r){void 0===e&&r(new s.Prototypes.Error({code:"Convoy",message:"No Convoy defined for dispatch."},this)),"function"==typeof n&&n.ajax?n.ajax({type:"POST",url:"/Api"+encodeURIComponent(o||""),data:{convoy:JSON.stringify(e)},dataType:t.has(e,"meta")&&t.has(e.meta,"dataType")?e.meta.dataType:"json",xhrFields:{withCredentials:!0},crossDomain:!0,headers:{"Access-Control-Allow-Origin":"*"},success:function(e){return i(e),e},error:function(e){return r(new s.Prototypes.Error({code:"Convoy",message:e},this)),e}}):s.Internals.XHR({method:"POST",url:"/Api"+encodeURIComponent(o||""),data:{convoy:JSON.stringify(e)},type:t.has(e,"meta")&&t.has(e.meta,"dataType")?e.meta.dataType:"application/json",success:function(e){return e=e.payload||e,i(e),e},error:function(e){return r(new s.Prototypes.Error({code:"Convoy",message:e},this)),e}})})},s.Internals.CssLoader=function(e){return new Promise(function(t,n){if(e in s.CSS)return void(s.CSS[e]?t():s.Events.once("onload:"+e,t));s.CSS[e]=!1;let o=document.createElement("link");o.type="text/css",o.rel="stylesheet",o.href=e,s.Events.once("onload:"+e,function(){s.CSS[e]=!0,t()}),"onload"in o&&!s.Client.android?o.onload=function(){s.Events.trigger("onload:"+e)}:(s.CSS[e]=!0,s.Events.trigger("onload:"+e)),s("head").append(o)})},s.Internals.GetColWidth=function(e){if(void 0===e||!e)return!1;let t=e.attr("class");if(void 0===t||!t)return!1;let n=/col-.{2}-([0-9]*)/g.exec(t);return!(void 0===n||!n)&&(void 0!==n[1]&&n[1])},s.Internals.GetScrollDir=function(){let e=n(s.Environment.get("viewPort")||window).scrollTop(),t=s.Environment.get("windowTop");return!!t&&e>t?"down":!!(!!t&&e<t)&&"up"},s.Internals.IsOnScreen=function(e,t,o){if(!e)return!1;if(e instanceof n||(e=n(e)),!e.length)return!1;t=t||0,"boolean"!=typeof o&&(o=!0);let i=s.Environment.get("viewPort")||window,r=n(i).scrollTop(),a=r+n(i).height(),l=e.offset().top;i!==window&&(l+=r);let c=l+e.height();return r+=t,a-=t,o?l<=a&&c>=r:r<l&&a>c},s.Internals.LoadCss=function(e){return new Promise(function(n,o){void 0!==e&&"function"!=typeof e||o(new s.Prototypes.Error({code:"LoadCSS",message:"CSS Resource URLs must be defined as a String, Array, or Object."},this)),"string"==typeof e&&(e=[e]);let i={total:e.length,iteration:0};i.total>0?t.each(e.reverse(),function(e){i.iteration++;let r=t.uniqueId("css_");i[r]=!1,void 0!==e&&e?s.Internals.CssLoader(e).then(function(e){i[r]=!0,i.total===i.iteration&&t.allTrue(i)&&n(i)},o):(i[r]=!0,i.total===i.iteration&&t.allTrue(i)&&n(i))}):o(new s.Prototypes.Error({code:"LoadCSS",message:"No CSS Resource URLs found!"},this))})},s.Internals.LoadEnvironment=function(){let e=s("body").attr("data-environment");e&&"object"==typeof e&&t.size(e)&&s.Environment.set(e);let n=!1;try{(s.Environment.get("viewPort")||window).addEventListener("test",null,Object.defineProperty({},"passive",{get:function(){n={passive:!0}}}))}catch(e){}s.Environment.set("passiveEventOptions",n)},s.Internals.LoadImage=function(e){if(!e.el)return setTimeout(function(){s.Internals.LoadImage(e)},500),!1;let o=e.el instanceof n?e.el:n(e.el);if(!o.length)return setTimeout(function(){s.Internals.LoadImage(e)},500),!1;o.hasClass("placeholder")||(o.addClass("placeholder"),o.on("load",function(){o.removeClass("placeholder")})),s.Internals.IsOnScreen(e.spy||o)&&!t.hydrate(o.attr("data-loading"))&&(o.attr("data-loading",t.dehydrate(!0)),s.DOM.complete(function(){let i=t.hydrate(o.attr("data-hd"));void 0===i&&(i=!0);let r=t.hydrate(o.attr("data-src"))||o.attr("src")||null,a=o.prop("tagName").toLowerCase();if("img"!==a||"lazy"!==r&&!t.isEmpty(r)||(r=o.attr("src")),t.isEmpty(r))return!1;let l=t.hydrate(o.attr("data-size"))||e.size||null;if(!l){let r=null,a=null,c=null;if(o.width()?r=o.width():o.attr("width")&&(r=o.attr("width")),r){a=(r=/([\d]+)(.*)/.exec(r))[2],r=parseInt(r[1]),c="%"===a?r/100:null}if(!r||"%"===a){let i=t.hydrate(o.attr("data-ignore-visibility"))?null:":visible",a=n(t.first(n(e.el).parents(i)));r=a?a.width():0;let l=a.find('[class*="col-"]');if(l.length>0){let e=s.Internals.GetColWidth(l);e&&(r=Math.round(r/e))}c&&(r=Math.round(r*c))}if(r<=0)return setTimeout(function(){o.attr("data-loading",t.dehydrate(!1)),s.Internals.LoadImage(e)},500),!1;i&&(r*=2),"xs"===(l=(l=t.findKey(s.Settings.image.size,function(e){let t=e/r;return t>.85&&t<1.15||e>r}))||"hq")&&setTimeout(function(){o.attr("data-loading",t.dehydrate(!1)),s.Internals.LoadImage(e)},1500)}const c=r,u=/^(.+?)(-[A-Z]{2})?\.(?=[^.]*$)(.+)/gi.exec(r);null!==u?r=u[1]+"-"+l+"."+u[3]:console.error("Unable to find file name for image src:",o),o.addClass("loading");let d=c.startsWith("//")?window.location.protocol+c:c;if("img"===a)o.on("load",function(){o.addClass("loaded").removeClass("loading")}),o.on("error",function(){o.attr("data-loading",t.dehydrate(!1)),o.attr("src",d),console.log("Unable to load",l.toUpperCase(),"size.","Restored:",o.attr("src"))});else{let e=n("<img/>");e.attr("src",d),e.on("load",function(){o.addClass("loaded").removeClass("loading"),n(this).remove()}),e.on("error",function(){o.attr("data-loading",t.dehydrate(!1)),o.css("background-image","url("+d+")"),console.log("Unable to load",l.toUpperCase(),"size.","Restored:",d)})}let h=r.startsWith("//")?window.location.protocol+r:r;o.attr("data-loading",t.dehydrate(!1)),o.attr("data-size",t.dehydrate(l)),"img"===a?o.attr("src",h):o.css("background-image","url("+h+")"),s.RegisterGroup.remove("OnScroll",e)}))},s.Internals.Location=function(e){return new Promise(function(n,o){"geolocation"in navigator?(e=t.extend({enableHighAccuracy:!0,timeout:2e4,maximumAge:5e4},e||{}),navigator.geolocation.getCurrentPosition(n,o,e)):o(new s.Prototypes.Error({code:"Location",message:"HTML5 Geo-Location isn't supported on this browser."},this))})},s.Internals.OnScroll=t.once(function(e){s.Environment.on("change:viewPortChange",function(e,o){if(!o.get("viewPortChange"))return;o.set("lastScroll",s.Internals.GetScrollDir());let i=s.RegisterGroup.get("OnScroll");t.each(i,function(e){void 0!==e&&t.has(e,"method")&&e.method(e)}),o.set("viewPortChange",!1),o.set("windowTop",n(s.Environment.get("viewPort")||window).scrollTop())});const o=s.Environment.get("viewPort")||window,i=t.throttle(function(){s.Environment.get("viewPortChange")||s.Environment.set("viewPortChange",!0)},120);o.addEventListener("scroll",i,s.Environment.get("passiveEventOptions")),o.addEventListener("resize",i,s.Environment.get("passiveEventOptions")),s.DOM.complete(function(){s.Environment.set("viewPortChange",!0)})}),s.Internals.Resource=function(e,n){return new Promise(function(o,i){if(void 0===e&&i(new s.Prototypes.Error({code:"Resource",message:"Resource path is not defined."},this)),t.has(s.Resources,e))s.Resources[e].success?o(s.Resources[e].data):s.Events.once("resource:"+e,o);else{s.Resources[e]={success:!1,data:null},s.Events.once("resource:"+e,o);let t={path:e,dataType:"text"};void 0!==n&&(t.elementId=n),s.Internals.Api("Resource",t,{}).then(function(t){s.Resources[e].success=!0,s.Resources[e].data=t,s.Events.trigger("resource:"+e,t)},i)}})},s.Internals.SetUrlParams=function(e,n){return t.setUrlParams(e,n)},s.Internals.TrackLocation=function(){let e={};e.timezone=(new Date).toString().match(/\((.*)\)/)[1],s.Environment.get("trackLocation")?s.Environment.get("trackLocationConsent")?s.Internals.Location().then(function(t){e.lat=t.coords.latitude,e.lng=t.coords.longitude,s.Environment.set("lat",t.coords.latitude),s.Environment.set("lng",t.coords.longitude),s.Internals.UpdateEnvironment(e)},function(e){console.error("Stratus Location:",e)}):s.Internals.XHR({url:"https://ipapi.co/"+s.Environment.get("ip")+"/json/",success:function(t){t||(t={}),"object"==typeof t&&Object.keys(t).length&&t.postal&&(e.postalCode=t.postal,e.lat=t.latitude,e.lng=t.longitude,e.city=t.city,e.region=t.region,e.country=t.country,s.Internals.UpdateEnvironment(e))}}):s.Internals.UpdateEnvironment(e)},s.Internals.UpdateEnvironment=function(e){if(e||(e={}),"string"!=typeof document.cookie||!t.cookie("SITETHEORY"))return!1;"object"==typeof e&&Object.keys(e).length&&s.Internals.XHR({method:"PUT",url:"/Api/Session",data:e,type:"application/json",success:function(e){let n=e.payload||e;"object"==typeof n&&t.each(Object.keys(n),function(e){s.Environment.set(e,n[e])})},error:function(e){console.error("error:",e)}})},s.Select=function(e,n){n||(n=document);let o=e;if("string"==typeof e){let s;o=n[s=t.startsWith(e,".")||t.contains(e,"[")?"querySelectorAll":t.contains(["html","head","body"],e)||t.startsWith(e,"#")?"querySelector":"querySelectorAll"](e)}return o&&"object"==typeof o&&((t.isAngular(o)||t.isjQuery(o))&&(o=o.length?t.first(o):{}),o=t.extend({},s.Selector,{context:this,length:t.size(o),selection:o,selector:e})),o},(s=t.extend(function(e,t){return s.Select(e,t)},s)).Selector.attr=function(e,n){let o=this;return o.selection instanceof window.NodeList?(console.warn('Unable to find "'+e+'" for list:',o.selection),null):e?void 0===n?(n=o.selection.getAttribute(e),t.hydrate(n)):(o.selection.setAttribute(e,t.dehydrate(n)),o):this},s.Selector.each=function(e){let n=this;return"function"!=typeof e&&(e=function(e){console.warn("each running on element:",e)}),n.selection instanceof window.NodeList&&t.each(n.selection,e),n},s.Selector.find=function(e){let t=this;if(t.selection instanceof window.NodeList)console.warn('Unable to find "'+e+'" for list:',t.selection);else if(e)return s(e,t.selection);return null},s.Selector.map=function(e){let n=this;return"function"!=typeof e&&(e=function(e){console.warn("map running on element:",e)}),n.selection instanceof window.NodeList?t.map(n.selection,e):n},s.Selector.append=function(e){let t=this;return t.selection instanceof window.NodeList?console.warn("Unable to append child:",e,"to list:",t.selection):e&&t.selection.insertBefore(e,t.selection.lastChild),t},s.Selector.prepend=function(e){let t=this;return t.selection instanceof window.NodeList?console.warn("Unable to prepend child:",e,"to list:",t.selection):e&&t.selection.insertBefore(e,t.selection.firstChild),t},s.Selector.addClass=function(e){let n=this;return n.selection instanceof window.NodeList?console.warn('Unable to add class "'+e+'" to list:',n.selection):t.each(e.split(" "),function(e){n.selection.classList?n.selection.classList.add(e):n.selection.className+=" "+e}),n},s.Selector.removeClass=function(e){let n=this;return n.selection instanceof window.NodeList?console.warn('Unable to remove class "'+e+'" from list:',n.selection):n.selection.classList?t.each(e.split(" "),function(e){n.selection.classList.remove(e)}):n.selection.className=n.selection.className.replace(new RegExp("(^|\\b)"+e.split(" ").join("|")+"(\\b|$)","gi")," "),n},s.Selector.style=function(){let e=this;if(e.selection instanceof window.NodeList)console.warn("Unable to find style for list:",e.selection);else if(e.selection instanceof window.Node)return window.getComputedStyle(e.selection);return null},s.Selector.height=function(){let e=this;return e.selection instanceof window.NodeList?(console.warn("Unable to find height for list:",e.selection),null):e.selection.offsetHeight||0},s.Selector.width=function(){let e=this;return e.selection instanceof window.NodeList?(console.warn("Unable to find width for list:",e.selection),null):e.selection.offsetWidth||0},s.Selector.offset=function(){let e=this;if(e.selection instanceof window.NodeList)console.warn("Unable to find offset for list:",e.selection);else if(e.selection.getBoundingClientRect){let t=e.selection.getBoundingClientRect();return{top:t.top+document.body.scrollTop,left:t.left+document.body.scrollLeft}}return{top:null,left:null}},s.Selector.parent=function(){let e=this;return e.selection instanceof window.NodeList?(console.warn("Unable to find offset for list:",e.selection),null):s(e.selection.parentNode)},s.Loaders.Angular=function(){let e,o,i,r={requirement:[],module:[],stylesheet:[]},a=function(e){e=e||{},t.each(e,function(e,n){r[n]=r[n]||[],t.isArray(e)?t.each(e,function(e){r[n].push(e)}):r[n].push(e)})};t.each(s.Roster,function(n,s){if("object"==typeof n&&n)if(t.isUndefined(n.selector)&&n.namespace&&(n.selector=t.filter(t.map(boot.configuration.paths,function(e,o){return t.startsWith(o,n.namespace)?("attribute"===n.type?"[":"")+t.camelToKebab(o.replace(n.namespace,"stratus-"))+("attribute"===n.type?"]":""):null}))),t.isArray(n.selector))n.length=0,t.each(n.selector,function(s){if(o=document.querySelectorAll(s),n.length+=o.length,o.length){let o=s.replace(/^\[/,"").replace(/]$/,"");e=n.namespace+t.lcfirst(t.kebabToCamel(o.replace(/^stratus/,"").replace(/^ng/,""))),t.has(boot.configuration.paths,e)&&(i={requirement:e},n.module&&(i.module=t.isString(n.module)?n.module:t.lcfirst(t.kebabToCamel(o+(n.suffix||"")))),a(i))}});else if(t.isString(n.selector)&&(o=document.querySelectorAll(n.selector),n.length=o.length,o.length)){let s=n.selector.replace(/^\[/,"").replace(/]$/,"");s&&n.namespace?t.each(o,function(o){let i=o.getAttribute(s);i&&(e=n.namespace+t.lcfirst(t.kebabToCamel(i.replace("Stratus",""))),t.has(boot.configuration.paths,e)&&a({requirement:e}))}):n.require&&(r.requirement=t.union(r.requirement,n.require),i={},n.module&&(i.module=t.isString(n.module)?n.module:t.lcfirst(t.kebabToCamel(s+(n.suffix||"")))),n.stylesheet&&(i.stylesheet=n.stylesheet),a(i))}}),r.requirement.push("angular-material"),t.each(r,function(e,n){r[n]=t.uniq(e)}),window.container=r,r.requirement.length&&(Object.keys(boot.configuration.paths).filter(function(e){return t.startsWith(e,"stratus.filters.")}).forEach(function(e){r.requirement.push(e)}),require(r.requirement,function(){if(angular.module("stratusApp",t.union(Object.keys(s.Modules),r.module)).config(["$sceDelegateProvider",function(e){let n=["self","http://*.sitetheory.io/**","https://*.sitetheory.io/**"];boot.host&&(t.startsWith(boot.host,"//")?t.each(["https:","http:"],function(e){n.push(e+boot.host+"/**")}):n.push(boot.host+"/**")),e.resourceUrlWhitelist(n)}]),"function"==typeof n&&n.fn&&n.FroalaEditor){n.FroalaEditor.DEFAULTS.key=s.Api.Froala;let e=["bold","italic","underline","strikeThrough","subscript","superscript","|","formatBlock","blockStyle","inlineStyle","paragraphStyle","paragraphFormat","align","formatOL","formatUL","outdent","indent","|","insertLink","insertImage","insertVideo","insertFile","insertTable","|","undo","redo","removeFormat","wordPaste","help","html","fullscreen"];angular.module("stratusApp").value("froalaConfig",{codeBeautifierOptions:{end_with_newline:!0,indent_inner_html:!0,extra_liners:"['p', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'blockquote', 'pre', 'ul', 'ol', 'table', 'dl']",brace_style:"expand",indent_char:" ",indent_size:4,wrap_line_length:0},codeMirror:!0,codeMirrorOptions:{indentWithTabs:!1,lineNumbers:!0,lineWrapping:!0,mode:"text/html",tabMode:"space",tabSize:4},fileUploadURL:"https://app.sitetheory.io:3000/?session="+t.cookie("SITETHEORY"),htmlAllowedAttrs:[".*"],htmlAllowedEmptyTags:["textarea","a",".fa","iframe","object","video","style","script","div"],htmlAllowedTags:[".*"],htmlRemoveTags:[""],htmlUntouched:!0,imageManagerPageSize:20,imageManagerScrollOffset:10,imageManagerLoadURL:"/Api/Media?payload-only=true",imageManagerLoadMethod:"GET",imageManagerDeleteMethod:"DELETE",multiLine:!0,pasteDeniedAttrs:[""],pasteDeniedTags:[""],pastePlain:!1,toolbarSticky:!1,toolbarButtons:e,toolbarButtonsMD:e,toolbarButtonsSM:e,toolbarButtonsXS:e})}t.each(s.Services,function(e){angular.module("stratusApp").config(e)}),t.each(s.Components,function(e,n){angular.module("stratusApp").component("stratus"+t.ucfirst(n),e)}),t.each(s.Directives,function(e,n){angular.module("stratusApp").directive("stratus"+t.ucfirst(n),e)}),t.each(s.Filters,function(e,n){angular.module("stratusApp").filter(t.lcfirst(n),e)}),t.each(s.Controllers,function(e,t){angular.module("stratusApp").controller(t,e)});let e=r.stylesheet,o=s("link[satisfies]").map(function(e){return e.getAttribute("satisfies")});if(t.contains(o,"angular-material.css")||e.push(s.BaseUrl+s.BundlePath+"node_modules/angular-material/angular-material"+(s.Environment.get("production")?".min":"")+".css"),(s.Directives.Froala||s("[froala]").length)&&[s.BaseUrl+"sitetheorycore/css/sitetheory.codemirror.css",s.BaseUrl+s.BundlePath+"node_modules/codemirror/lib/codemirror.css",s.BaseUrl+s.BundlePath+"node_modules/froala-editor/css/froala_editor.min.css",s.BaseUrl+s.BundlePath+"node_modules/froala-editor/css/froala_style.min.css",s.BaseUrl+s.BundlePath+"node_modules/froala-editor/css/plugins/code_view.min.css",s.BaseUrl+s.BundlePath+"node_modules/froala-editor/css/plugins/draggable.min.css",s.BaseUrl+s.BundlePath+"node_modules/froala-editor/css/plugins/file.min.css",s.BaseUrl+s.BundlePath+"node_modules/froala-editor/css/plugins/fullscreen.min.css",s.BaseUrl+s.BundlePath+"node_modules/froala-editor/css/plugins/help.min.css",s.BaseUrl+s.BundlePath+"node_modules/froala-editor/css/plugins/image.min.css",s.BaseUrl+s.BundlePath+"node_modules/froala-editor/css/plugins/image_manager.min.css",s.BaseUrl+s.BundlePath+"node_modules/froala-editor/css/plugins/quick_insert.min.css",s.BaseUrl+s.BundlePath+"node_modules/froala-editor/css/plugins/special_characters.min.css",s.BaseUrl+s.BundlePath+"node_modules/froala-editor/css/plugins/table.min.css",s.BaseUrl+s.BundlePath+"node_modules/froala-editor/css/plugins/video.min.css"].forEach(function(t){e.push(t)}),e.length){let t=0;e.forEach(function(n){s.Internals.CssLoader(n).then(function(){++t===e.length&&angular.bootstrap(document.querySelector("html"),["stratusApp"])})})}else angular.bootstrap(document.querySelector("html"),["stratusApp"])}))},s.Instances.Clean=function(e){if(void 0===e?console.error("Stratus.Instances.Clean() requires a string or array containing Unique ID(s)."):"string"==typeof e&&(e=[e]),"object"!=typeof e||!Array.isArray(e))return!1;t.each(e,function(e){t.has(s.Instances,e)&&("function"==typeof s.Instances[e].remove&&s.Instances[e].remove(),delete s.Instances[e])})};s.Aether=new class extends s.Prototypes.Model{constructor(e,t){super(e,t),this.passiveSupported=!1,s.Environment.get("production")||console.info("Aether Invoked!");let n=this;try{let e={get passive(){n.passiveSupported=!0}};window.addEventListener("test",e,e),window.removeEventListener("test",e,e)}catch(e){n.passiveSupported=!1}this.on("change",this.synchronize,this)}synchronize(){s.Environment.get("production")||console.info("Aether Synchronizing..."),t.isEmpty(this.data)&&console.warn("synchronize: no data!"),t.each(this.data,function(e,t){!e.listening&&e.enabled&&(s.Environment.get("viewPort")&&console.warn("Aether does not support custom viewPorts:",s.Environment.get("viewPort")),(e.target||window).addEventListener(e.hook,e.method,!!this.passiveSupported&&{capture:!0,passive:!0}),e.listening=!0)},this)}listen(e){let n=null,o=new s.Prototypes.Event(e);return o.invalid||(n=t.uniqueId("event_"),this.set(n,o),s.Instances[n]=o),n}};return s.Chronos=new class extends s.Prototypes.Model{constructor(e,t){super(e,t),s.Environment.get("production")||console.info("Chronos Invoked!"),this.on("change",this.synchronize,this)}synchronize(){s.Environment.get("production")||console.info("Chronos Synchronizing..."),t.isEmpty(this.changed)&&console.warn("synchronize: empty changeset!"),t.each(this.changed,function(e,n){"string"==typeof n&&-1!==n.indexOf(".")&&(n=t.first(n.split(".")),e=this.get(n)),!e.code&&e.enabled?e.code=setInterval(function(e){e.method.call(e.scope)},1e3*e.time,e):e.code&&!e.enabled&&(clearInterval(e.code),e.code=0)},this)}queue(e,n,o){const i=e instanceof s.Prototypes.Job?e:new s.Prototypes.Job(e,n,o);if(null===i.time||"function"!=typeof i.method)return null;const r=t.uniqueId("job_");return this.set(r,i),s.Instances[r]=i,r}enable(e){return!!this.has(e)&&(this.set(e+".enabled",!0),!0)}disable(e){return!!this.has(e)&&(this.set(e+".enabled",!1),!0)}toggle(e,t){return!!this.has(e)&&(this.set(e+".enabled","boolean"==typeof t?t:!this.get(e+".enabled")),!0)}},s.PostMessage.Convoy=function(e){window.addEventListener("message",function(n){if("https://auth.sitetheory.io"!==n.origin)return!1;e(t.isJSON(n.data)?JSON.parse(n.data):{})},!1)},s.PostMessage.Convoy(function(e){let n=t.cookie("sso");(n=null===n||!!t.isJSON(n)&&JSON.parse(n))&&e&&e.meta&&e.meta.session&&e.meta.session!==t.cookie("SITETHEORY")&&(t.cookie({name:"SITETHEORY",value:e.meta.session,expires:"1w"}),s.Client.safari||window.location.reload(!0))}),s.LocalStorage.Listen=function(e,t){window.addEventListener("storage",function(n){n.key===e&&t(n)},!1)},s.LocalStorage.Listen("stratus-core",function(e){}),s.DOM.ready=function(e){"loading"!==document.readyState?e():document.addEventListener("DOMContentLoaded",e)},s.DOM.complete=function(e){"complete"===document.readyState?e():window.addEventListener("load",e)},s.DOM.unload=function(e){window.addEventListener("beforeunload",e)},s.Key.Enter=13,s.Key.Escape=27,s.Events.once("initialize",function(){s.Environment.get("production")||(console.groupEnd(),console.group("Stratus Initialize")),s.Internals.LoadEnvironment(),s.Internals.Compatibility(),s.RegisterGroup=new s.Prototypes.Model,s.Internals.TrackLocation(),s.Loaders.Angular()}),s.Events.once("finalize",function(){s.Environment.get("production")||(console.groupEnd(),console.group("Stratus Finalize")),s.Internals.Anchor.initialize&&(s.Internals.Anchor=s.Internals.Anchor());let e=new s.Internals.Anchor;s.Environment.get("production")||console.log("Anchor:",e),s.RegisterGroup.size()&&s.RegisterGroup.each(function(e,n){t.has(s.Internals,n)&&(s.Internals[n](e),s.Environment.get("production")||console.log("Register Group: remove - ",n,e))})}),s.Events.once("terminate",function(){s.Environment.get("production")||(console.groupEnd(),console.group("Stratus Terminate"))}),s.Events.on("alert",function(e,t,n){t instanceof s.Prototypes.Bootbox||(t=new s.Prototypes.Bootbox(t,n)),"undefined"!=typeof bootbox?bootbox.alert(t.message,t.handler):(window.alert(t.message),t.handler())}),s.Events.on("confirm",function(e,t,n){t instanceof s.Prototypes.Bootbox||(t=new s.Prototypes.Bootbox(t,n)),"undefined"!=typeof bootbox?bootbox.confirm(t.message,t.handler):n(window.confirm(t.message))}),s.Events.on("notification",function(e,n,o){let i,r={};n&&"object"==typeof n?(t.extend(r,n),r.message=r.message||"Message"):r.message=n||"Message",r.title=r.title||o||"Stratus",r.icon=r.icon||"https://avatars0.githubusercontent.com/u/15791995?v=3&s=200","Notification"in window?"granted"===window.Notification.permission?(i=new window.Notification(r.title,{body:r.message,icon:r.icon}),s.Environment.get("production")||console.log(i)):"denied"!==window.Notification.permission&&window.Notification.requestPermission(function(e){"granted"===e&&(i=new window.Notification(r.title,{body:r.message,icon:r.icon}),s.Environment.get("production")||console.log(i))}):console.info("This browser does not support desktop notifications.  You should switch to a modern browser.")}),s.Events.on("toast",function(e,t,o,i,r){t instanceof s.Prototypes.Toast||(t=new s.Prototypes.Toast(t,o,i,r)),s.Environment.get("production")||console.log("Toast:",t),void 0!==n&&n.toaster?n.toaster(t):s.Events.trigger("alert",t.message)}),s.DOM.ready(function(){s("body").removeClass("loaded unloaded").addClass("loading"),s.Events.trigger("initialize")}),s.DOM.complete(function(){s("body").removeClass("loading unloaded").addClass("loaded"),hamlet.isUndefined("System")||require(["@stratus/angular/boot"])}),s.DOM.unload(function(e){s("body").removeClass("loading loaded").addClass("unloaded"),s.Events.trigger("terminate",e)}),s,s});